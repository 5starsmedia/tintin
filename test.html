<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Document</title>
</head>
<body>

<canvas id="myCanvas" style="width:200px; height: 100px;"></canvas>

<script>
  var graph = function(id, width, height, maxX, maxY) {
    var ctx = document.getElementById(id).getContext("2d"),
        values = [];

    ctx.lineWidth = 3;

    function getCurvePoints(ptsa, tension, isClosed, numOfSegments) {
      tension = (typeof tension != 'undefined') ? tension : 0.5;
      isClosed = isClosed ? isClosed : false;
      numOfSegments = numOfSegments ? numOfSegments : 16;

      var _pts = [], res = [],
          x, y,
          t1x, t2x, t1y, t2y,
          c1, c2, c3, c4,
          st, t, i;

      var pts = ptsa;
      _pts = ptsa.slice(0);

      if (isClosed) {
        _pts.unshift(pts[pts.length - 1]);
        _pts.unshift(pts[pts.length - 2]);
        _pts.unshift(pts[pts.length - 1]);
        _pts.unshift(pts[pts.length - 2]);
        _pts.push(pts[0]);
        _pts.push(pts[1]);
      }
      else {
        _pts.unshift(pts[1]);
        _pts.unshift(pts[0]);
        _pts.push(pts[pts.length - 2]);
        _pts.push(pts[pts.length - 1]);
      }

      for (i=2; i < (_pts.length - 4); i+=2) {
        for (t=0; t <= numOfSegments; t++) {

          t1x = (_pts[i+2] - _pts[i-2]) * tension;
          t2x = (_pts[i+4] - _pts[i]) * tension;

          t1y = (_pts[i+3] - _pts[i-1]) * tension;
          t2y = (_pts[i+5] - _pts[i+1]) * tension;

          st = t / numOfSegments;

          c1 =   2 * Math.pow(st, 3)  - 3 * Math.pow(st, 2) + 1;
          c2 = -(2 * Math.pow(st, 3)) + 3 * Math.pow(st, 2);
          c3 =       Math.pow(st, 3)  - 2 * Math.pow(st, 2) + st;
          c4 =       Math.pow(st, 3)  -     Math.pow(st, 2);

          x = c1 * _pts[i]    + c2 * _pts[i+2] + c3 * t1x + c4 * t2x;
          y = c1 * _pts[i+1]  + c2 * _pts[i+3] + c3 * t1y + c4 * t2y;

          res.push(x);
          res.push(y);

        }
      }

      return res;
    }
    function drawLines(ctx, pts) {
      ctx.moveTo(pts[0], pts[1]);
      for(i=2;i<pts.length-1;i+=2) ctx.lineTo(pts[i], pts[i+1]);
    }
    function drawCurve(ctx, ptsa, tension, isClosed, numOfSegments, showPoints) {

      showPoints  = showPoints ? showPoints : false;

      ctx.beginPath();

      drawLines(ctx, getCurvePoints(ptsa, tension, isClosed, numOfSegments));

      if (showPoints) {
        ctx.stroke();
        ctx.beginPath();
        for(var i=0;i<pts.length-1;i+=2)
          ctx.rect(pts[i] - 2, pts[i+1] - 2, 4, 4);
      }
    }

    this.addValue = function(value) {
      values.push(parseInt(value));
      if (values.length > maxX) {
        values = values.splice(1, values.length);
      }
      this.redraw();
    };
    this.calcX = function(x) {
      return x * maxX / width * 100;
    };
    this.calcY = function(y) {
      return y / maxY * 100;
    };
    this.redraw = function() {
      if (values.length < 1) {
        return;
      }
      ctx.clearRect(-1, -1, 300, 300);
      var points = [];
      for (var j = 1; j < values.length; j++) {
        points.push(j * 5);
        points.push(values[j]);
      }
      drawCurve(ctx, points);
      ctx.arc(points[points.length - 2],points[points.length - 1],2,0,2*Math.PI);
      ctx.stroke();
    }
  };

  var maxX = 100,
      maxY = 100;
  var g = new graph('myCanvas', 200, 100, maxX, maxY);
  setInterval(function() {
    g.addValue(
      Math.random() * maxY
    );
  }, 100);
</script>

</body>
</html>